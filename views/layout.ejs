<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <title>–í–∏–¥–µ–æ–ü—Ä–æ–∫–∞—Ç</title>
  <link rel="stylesheet" href="/css/style.css">
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
</head>
<body>
  <header>
    <h1>üé¨ –í–∏–¥–µ–æ–ü—Ä–æ–∫–∞—Ç</h1>
    <nav>
      <a href="/">–ì–ª–∞–≤–Ω–∞—è</a>
      <a href="/rentals">–ê—Ä–µ–Ω–¥–∞</a>
      <% if (user) { %>
        <% if (user.role === 'admin'|| user.role === 'distr') { %>
          <a href="/media">–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –º–µ–¥–∏–∞</a>
        <% } %>
        <% if (user.role === 'admin') { %>
          <a href="/clients">–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏</a>
        <% } %>
        <a href="/logout">–í—ã–π—Ç–∏</a>
      <% } else { %>
        <a href="/login">–í—Ö–æ–¥</a>
        <a href="/register">–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</a>
      <% } %>
    </nav>
  </header>

  <main>
    <%- body %>
  </main>

  <footer>
    &copy; <%= new Date().getFullYear() %> –í–∏–¥–µ–æ–ü—Ä–æ–∫–∞—Ç
  </footer>
</body>
</html>
<script>
$(document).ready(function () {
  $('.rent-btn').click(function () {
    const $li = $(this).closest('li');
    const mediaId = $li.data('id');
    const type = $(this).data('type');

    $.ajax({
      url: `/rentals/${mediaId}?type=${type}`,
      method: 'POST',
      success: function (response) {
        alert(response.message);
        location.reload(); // –æ–±–Ω–æ–≤–∏–º —Å–ø–∏—Å–æ–∫ –ø–æ—Å–ª–µ –¥–µ–π—Å—Ç–≤–∏—è
      },
      error: function (xhr) {
        alert(xhr.responseText || '–ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞');
      }
    });
  });
});
</script>

